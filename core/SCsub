#!/usr/bin/env python

Import("env")

import core_builders
import make_binders
from platform_methods import run_in_subprocess

env.core_sources = []

# Godot's own sources
env.add_source_files(env.core_sources, "*.cpp")

# License
env.Depends("#core/license.gen.h", ["../COPYRIGHT.txt", "../LICENSE.txt"])
env.CommandNoCache(
    "#core/license.gen.h", ["../COPYRIGHT.txt", "../LICENSE.txt"], run_in_subprocess(core_builders.make_license_header)
)

# Chain load SCsubs
SConscript("os/SCsub") # ok
SConscript("math/SCsub") # ok
SConscript("crypto/SCsub") # pas fun
SConscript("io/SCsub") # ok
SConscript("debugger/SCsub") # ok
SConscript("input/SCsub") # pas fun
SConscript("bind/SCsub") # OK


# Build it all as a library
lib = env.add_library("core", env.core_sources)
env.Prepend(LIBS=[lib])
